name: test

on:
  workflow_dispatch:

jobs:

  tag:
    name: 'Create tag'
    runs-on: ubuntu-latest
    permissions: write-all
    steps:
      - uses: actions/checkout@v3

      - shell: python
        run: |
          import json
          import os

          x = json.loads("""${{ toJSON(github) }}""", strict=False)
          with open(os.environ['GITHUB_OUTPUT'], 'a') as fh:
            print(f'json={json.dumps(x, )}', file=fh)
          with open("github_workload_dispatch.json", "w") as f:
            json.dump(x, f, indent=4)

      - name: 'Commit changes and push'
        # https://github.com/marketplace/actions/git-auto-commit
        uses: stefanzweifel/git-auto-commit-action@v4
        id: commit
        with:
          commit_message: 'release: updating changelog'
          commit_user_name: 'RepoDynamics[bot]'
          tagging_message: "v0.0.5"